{"version":3,"sources":["midk.yml","midi.ts","handlerType.ts","PianoSheet/midi.ts","PianoSheet/styled.ts","PianoSheet/Stave.tsx","PianoSheet/keySheet.tsx","PianoSheet/PianoSheet.tsx","PianoSheet/PianoApp.tsx","index.web.ts"],"names":["module","exports","PitchNotation","MessageStatus","NoteCode","listenMIDI","input","noteOn","noteOff","addListener","e","note","number","Backends","Clef","Background","styled","div","BodyContainer","NoteName","SharpNote","BaseNote","KeyName","Kbd","kbd","FnKbd","EmojiIcon","span","Piano","ReactPiano","StaveContainer","SwitchContainer","pianoHeight","Switch","AntSwitch","SwitchLabel","props","activated","KeyDisplay","backspace","delete","enter","tab","escape","up","ArrowUpOutlined","down","ArrowDownOutlined","right","ArrowRightOutlined","left","ArrowLeftOutlined","home","end","pageUp","pageDown","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","f13","f14","f15","f16","f17","f18","f19","f20","f21","f22","f23","f24","capsLock","command","alt","rightAlt","control","leftControl","rightControl","shift","rightShift","space","printScreen","insert","menu","audioMute","audioVolDown","audioVolUp","audioPlay","StepForwardOutlined","audioStop","audioPause","audioPrev","BackwardOutlined","audioNext","ForwardOutlined","audioRewind","audioForward","audioRepeat","audioRandom","numpadLock","num1","num2","num3","num4","num5","num6","num7","num8","num9","num0","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","numpadPlus","numpadSub","numpadMulti","numpadDiv","numpadDot","lightsMonUp","lightsMonDown","lightsKbdToggle","lightsKbdUp","lightsKbdDown","a","b","c","d","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","tilde","dash","equal","comma","dot","slash","semicolon","quotes","openBracket","closeBracket","backslash","fn","NULL","NoteLabel","noteCode","noteName","replace","NamedKeyLabel","portal","fnPortal","key","alterKeyMap","Map","Object","values","map","entries","reduce","prev","curr","filter","alterKey","get","Boolean","length","NoteKey","isAccidental","isPlayMode","noteLabel","NoteWrapper","S","Vex","Flow","Formatter","Renderer","Stave","StaveNote","Beam","transformToVexNote","genVexNotes","start","Array","from","_","index","includes","clef","C4","bass","treble","keys","duration","StaveSheet","className","width","noteRange","first","last","noteKeyWidth","container","useRef","trebleNotes","bassNotes","B3","useEffect","renderer","current","SVG","render","resize","context","getContext","bassStave","addClef","setContext","draw","bassBeams","generateBeams","FormatAndDraw","forEach","beam","trebleStave","trebleBeams","ref","midkConfig","playMode","toggles","Set","toggle","codeName","portalNotes","name","Math","min","max","notesWholeWidth","count","code","countWholeTones","noop","PlayModeSwitch","checked","rootElement","document","getElementById","ReactDOM","React","createElement","enable","useState","pressedNotes","setPressedNotes","onPressedNotes","add","getInput","WebMidi","inputs","connected","event","console","log","port","type","disconnected","removeListener","err","initReceiveMIDI","notes","isPress","set1","set2","size","renderNoteLabel","useCallback","midiNumber","url","process","backgroundColor","color","svgStyle","position","onChange","activeNotes","playNote","stopNote","disabled","keyWidthToHeight"],"mappings":"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","file":"static/js/main.059b2ebf.chunk.js","sourcesContent":["module.exports = {\"pitchNotation\":\"Scientific\",\"playMode\":{\"enable\":false,\"toggle\":[\"CSharp2\",\"DSharp2\",\"ASharp5\"]},\"portal\":{\"C2\":null,\"CSharp2\":\"escape\",\"D2\":\"home\",\"DSharp2\":null,\"E2\":\"end\",\"F2\":\"tilde\",\"FSharp2\":\"tab\",\"G2\":\"control\",\"GSharp2\":\"capsLock\",\"A2\":\"alt\",\"ASharp2\":\"shift\",\"B2\":\"command\",\"C3\":\"a\",\"CSharp3\":\"q\",\"D3\":\"z\",\"DSharp3\":\"w\",\"E3\":\"s\",\"F3\":\"x\",\"FSharp3\":\"e\",\"G3\":\"c\",\"GSharp3\":\"d\",\"A3\":\"f\",\"ASharp3\":\"r\",\"B3\":\"v\",\"C4\":\"space\",\"CSharp4\":\"t\",\"D4\":\"b\",\"DSharp4\":\"g\",\"E4\":\"h\",\"F4\":\"n\",\"FSharp4\":\"y\",\"G4\":\"j\",\"GSharp4\":\"u\",\"A4\":\"k\",\"ASharp4\":\"i\",\"B4\":\"m\",\"C5\":\"l\",\"CSharp5\":\"o\",\"D5\":\"comma\",\"DSharp5\":\"p\",\"E5\":\"dot\",\"F5\":\"slash\",\"FSharp5\":\"openBracket\",\"G5\":\"semicolon\",\"GSharp5\":\"closeBracket\",\"A5\":\"quotes\",\"ASharp5\":\"enter\",\"B5\":\"backslash\",\"C6\":\"left\",\"CSharp6\":\"backspace\",\"D6\":\"down\",\"DSharp6\":\"up\",\"E6\":\"right\",\"F6\":\"delete\",\"FSharp6\":\"backspace\",\"G6\":\"audioVolDown\",\"GSharp6\":\"audioVolUp\",\"A6\":\"lightsMonDown\",\"ASharp6\":\"lightsMonUp\",\"B6\":\"dash\",\"C7\":\"equal\"},\"fnPortal\":{\"C2\":{\"D2\":\"audioPrev\",\"DSharp2\":\"audioPlay\",\"E2\":\"audioNext\",\"CSharp3\":\"f1\",\"D3\":\"f2\",\"DSharp3\":\"f3\",\"E3\":\"f4\",\"F3\":\"f5\",\"FSharp3\":\"f6\",\"G3\":\"f7\",\"GSharp3\":\"f8\",\"A3\":\"f9\",\"ASharp3\":\"f10\",\"B3\":\"f11\",\"C4\":\"f12\",\"C6\":\"tilde\",\"CSharp6\":\"num1\",\"D6\":\"num2\",\"DSharp6\":\"num3\",\"E6\":\"num4\",\"F6\":\"num5\",\"FSharp6\":\"num6\",\"G6\":\"num7\",\"GSharp6\":\"num8\",\"A6\":\"num9\",\"ASharp6\":\"num0\",\"B6\":\"pageDown\",\"C7\":\"pageUp\"},\"CSharp2\":{\"ASharp5\":null}}}","export enum PitchNotation {\n  Scientific = 'Scientific',\n  Helmholtz = 'Helmholtz',\n}\n\n// https://www.midi.org/specifications/item/table-1-summary-of-midi-message\nexport enum MessageStatus {\n  noteOffEvent = 0b1000 << 4,\n  noteOnEvent = 0b1001 << 4,\n  polyphonicPressure = 0b1010 << 4,\n  controlChange = 0b1011 << 4,\n  programChange = 0b1100 << 4,\n  channelPressure = 0b1101 << 4,\n  pitchBendChange = 0b1110 << 4,\n}\n\nexport type MessageData = number\n\nexport type Message = [\n  MessageStatus,\n  MessageData,\n  MessageData,\n]\n\n// Scientific pitch notation\n// https://en.wikipedia.org/wiki/Scientific_pitch_notation\n// 88 keys: [A0 ... C8]\n// 61 keys: [C2 ... C7]\nexport enum NoteCode {\n  C0 = 12,\n  CSharp0,\n  D0,\n  DSharp0,\n  E0,\n  F0,\n  FSharp0,\n  G0,\n  GSharp0,\n  A0,\n  ASharp0,\n  B0,\n\n  C1,\n  CSharp1,\n  D1,\n  DSharp1,\n  E1,\n  F1,\n  FSharp1,\n  G1,\n  GSharp1,\n  A1,\n  ASharp1,\n  B1,\n\n  C2,\n  CSharp2,\n  D2,\n  DSharp2,\n  E2,\n  F2,\n  FSharp2,\n  G2,\n  GSharp2,\n  A2,\n  ASharp2,\n  B2,\n\n  C3,\n  CSharp3,\n  D3,\n  DSharp3,\n  E3,\n  F3,\n  FSharp3,\n  G3,\n  GSharp3,\n  A3,\n  ASharp3,\n  B3,\n\n  C4,\n  CSharp4,\n  D4,\n  DSharp4,\n  E4,\n  F4,\n  FSharp4,\n  G4,\n  GSharp4,\n  A4,\n  ASharp4,\n  B4,\n\n  C5,\n  CSharp5,\n  D5,\n  DSharp5,\n  E5,\n  F5,\n  FSharp5,\n  G5,\n  GSharp5,\n  A5,\n  ASharp5,\n  B5,\n\n  C6,\n  CSharp6,\n  D6,\n  DSharp6,\n  E6,\n  F6,\n  FSharp6,\n  G6,\n  GSharp6,\n  A6,\n  ASharp6,\n  B6,\n\n  C7,\n  CSharp7,\n  D7,\n  DSharp7,\n  E7,\n  F7,\n  FSharp7,\n  G7,\n  GSharp7,\n  A7,\n  ASharp7,\n  B7,\n\n  C8,\n  CSharp8,\n  D8,\n  DSharp8,\n  E8,\n  F8,\n  FSharp8,\n  G8,\n  GSharp8,\n  A8,\n  ASharp8,\n  B8,\n\n  C9,\n}\n\nexport type NoteNameKey = keyof typeof NoteCode\n\nexport type NoteVelocity = number\n\nexport type NoteEvent = Extract<\n  MessageStatus,\n  typeof MessageStatus.noteOnEvent | typeof MessageStatus.noteOffEvent\n>\n\nexport type NoteMessage = [\n  NoteEvent,\n  NoteCode,\n  NoteVelocity,\n]\n\nexport type Timestamp = number\n","\nimport {\n  NoteCode,\n} from './midi'\n\n\nexport type ToggleKeys = Set<NoteCode>\nexport type PressedNotes = Set<NoteCode>\n\nexport const isSetEqual = (set1: Set<NoteCode>, set2: Set<NoteCode>) => (\n  set1.size === set2.size && set1.size === new Set([...set1, ...set2]).size\n)\n","// https://github.com/djipco/webmidi\n\nimport WebMidi, * as MIDI from 'webmidi'\nimport { NoteCode } from '../midi'\nimport { PressedNotes } from '../handlerType'\n\n\nexport const listenMIDI = (\n  input: MIDI.Input,\n  noteOn?: (noteCode: NoteCode) => void,\n  noteOff?: (noteCode: NoteCode) => void,\n) => {\n  input?.addListener('noteon', 'all', e => noteOn?.(e.note.number))\n  input?.addListener('noteoff', 'all', e => noteOff?.(e.note.number))\n}\n\n\nexport const initReceiveMIDI = (\n  onPressedNotes: (notes: PressedNotes, pressed: boolean) => void,\n) => {\n  const pressedNotes: PressedNotes = new Set()\n\n  const noteOn = (noteCode: NoteCode) => {\n    pressedNotes.add(noteCode)\n    onPressedNotes(pressedNotes, true)\n  }\n  const noteOff = (noteCode: NoteCode) => {\n    pressedNotes.delete(noteCode)\n    onPressedNotes(pressedNotes, false)\n  }\n\n  const getInput = () => WebMidi.inputs[0]\n\n  const connected = (event: MIDI.WebMidiEventConnected) => {\n    console.log('WebMidi: connected()', 'event', event)\n    if (event.port.type !== 'input') return\n    listenMIDI(getInput(), noteOn, noteOff)\n  }\n\n  const disconnected = (event: MIDI.WebMidiEventDisconnected) => {\n    console.log('WebMidi: disconnected()', 'event', event)\n    if (event.port.type !== 'input') return\n    const input = getInput()\n    input?.removeListener('noteon')\n    input?.removeListener('noteoff')\n  }\n\n  WebMidi.enable((err) => {\n    if (err) {\n      console.log('WebMidi could not be enabled.', err)\n      return\n    }\n\n    const input = getInput()\n\n    if (input) {\n      console.log('WebMidi enabled.')\n      listenMIDI(input, noteOn, noteOff)\n    } else {\n      console.log('WebMidi midi input not found')\n      WebMidi.addListener('connected', connected)\n    }\n\n    WebMidi.addListener('disconnected', disconnected)\n  })\n}\n","import styled from '@emotion/styled'\nimport AntSwitch from 'antd/es/switch'\nimport { Piano as ReactPiano } from 'react-piano'\n\n\nexport const noteKeyWidth = 70\nexport const noteKeyWidthHeightRatio = 1 / 6\nexport const pianoHeight = noteKeyWidth / noteKeyWidthHeightRatio\nexport const pianoZoom = .8\n\nexport const Background = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nexport const BodyContainer = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  margin: auto;\n  justify-content: center;\n  zoom: ${pianoZoom};\n`\n\nexport const NoteName = styled.div`\n  padding: 0 0 2px 4px;\n  text-align: left;\n  color: var(--base-note-name-color);\n  font-size: 14px;\n  user-select: none;\n\n  sub {\n    position: absolute;\n    bottom: 0;\n  }\n`\n\nexport const SharpNote = styled.div`\n  padding-bottom: 8px;\n  color: var(--sharp-note-text-color);\n  text-shadow: 0 0 0 var(--sharp-note-text-color);\n`\n\nexport const BaseNote = styled.div`\n  color: var(--base-note-text-color);\n  text-shadow: 0 0 0 var(--base-note-text-color);\n`\n\nexport const KeyName = styled.div`\n  margin-bottom: 12px;\n  text-align: center;\n  font-size: 14px;\n\n  .anticon svg {\n    font-size: 16px;\n  }\n`\n\nexport const Kbd = styled.kbd`\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  height: 20px;\n  margin-top: 14px;\n  padding: 1px 5px;\n  min-width: 12px;\n  line-height: 20px;\n  text-align: center;\n  vertical-align: middle;\n  background-color: var(--kbd-background);\n  font-family: \"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace\";\n  border-radius: 3px;\n  border: 1px solid var(--kbd-border-color);\n  box-shadow: 0 1.5px 0 var(--kbd-border-color);\n\n  ::selection {\n    background: transparent;\n  }\n`\n\nexport const FnKbd = styled(Kbd)`\n  color: var(--active-note-color);\n  text-shadow: 0 0 0 var(--active-note-color);\n  border-color: var(--active-note-color);\n  box-shadow: 0 1.5px 0 var(--active-note-color);\n`\n\nexport const EmojiIcon = styled.span`\n  color: transparent;\n  font-size: 12px;\n\n  ::selection {\n    background: transparent;\n  }\n`\n\nexport const Piano = styled(ReactPiano)`\n  margin: 0 10px;\n\n  .ReactPiano__Key--natural {\n    background: var(--base-note-color);\n    border: none;\n    box-shadow: 0 0 0 1px var(--global-background);\n  }\n\n  .ReactPiano__Key--accidental {\n    height: 64%;\n    border: none;\n    background: var(--sharp-note-color);\n  }\n\n  .ReactPiano__Key--active {\n    border: none;\n    \n    &.ReactPiano__Key--natural {\n      height: unset;\n      background: var(--active-note-color);\n    }\n     \n    &.ReactPiano__Key--accidental {\n      background: var(--piano-header-background);\n    }    \n\n    &.ReactPiano__Key--natural, &.ReactPiano__Key--accidental {\n      .ReactPiano__NoteLabelContainer kbd {\n        color: var(--sharp-note-text-color);\n        text-shadow: 0 0 0 var(--sharp-note-text-color);\n        border: 1px solid var(--kbd-border-color);\n        box-shadow: 0 1.5px 0 var(--kbd-border-color);\n      }\n    }\n  }\n\n  .ReactPiano__Key {\n    border-top: 10px solid var(--piano-header-background);\n  }\n`\n\nexport const StaveContainer = styled.div`\n  position: absolute;\n  bottom: 0;\n  margin: 16px 10px auto;\n  pointer-events: none;\n`\n\nexport const SwitchContainer = styled.div`\n  position: fixed;\n  // piano is vertical center of view point, switch is 20px above it\n  bottom: calc(50vh + ${pianoHeight * pianoZoom / 2}px);\n  left: 0;\n  padding: 16px 0;\n  color: #fff;\n`\n\nexport const Switch = styled(AntSwitch)`\n  border-color: #fff;\n  &.ant-switch-checked {\n    background-color: var(--active-note-color);\n  }\n`\n\nexport const SwitchLabel = styled.span<{ activated?: boolean }>`\n  margin: auto 12px;\n  color: ${props => props.activated ? '#fff' : '#999'};\n  transition: all .3s;\n`\n","// https://github.com/0xfe/vexflow/wiki/The-VexFlow-Tutorial\n// http://public.vexflow.com/build/docs/\n\nimport React, { useEffect, useRef } from 'react'\nimport Vex, { Flow } from 'vexflow'\nimport { NoteCode } from '../midi'\nimport * as S from './styled'\n\nconst { Formatter, Renderer, Stave, StaveNote, Beam } = Vex.Flow\n\n// Cannot access ambient const enums when the '--isolatedModules' flag is provided\n// https://github.com/0xfe/vexflow/issues/749\n// https://github.com/0xfe/vexflow/blob/1.2.93/src/renderer.js#L14\n// https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/vexflow/index.d.ts#L797\nenum Backends {\n  CANVAS = 1,\n  RAPHAEL,\n  SVG,\n  VML,\n}\n\nexport enum Clef {\n  treble = 'treble',\n  bass = 'bass',\n}\n\nexport interface StaveProps {\n  className?: string,\n  width?: number,\n  noteRange: {\n    first: NoteCode,\n    last: NoteCode,\n  },\n  noteKeyWidth: number,\n\n  [key: string]: any,\n}\n\nexport const transformToVexNote = (noteCode: NoteCode): string => {\n  const noteName = NoteCode[noteCode]\n\n  /**\n   * CSharp4  -> C/4\n   * D3       -> D/3\n   */\n  return noteName.replace(/(Sharp)?(\\d)/, '/$2')\n}\n\nexport const genVexNotes = (start: NoteCode, end: NoteCode): Flow.StaveNote[] =>\n  Array.from({ length: end - start + 1 })\n    .map((_, index) => index + start)\n    .filter((noteCode: NoteCode) => !NoteCode[noteCode].includes('Sharp'))\n    .map((noteCode: NoteCode) =>\n      new StaveNote({\n        clef: noteCode < NoteCode.C4 ? Clef.bass : Clef.treble,\n        keys: [transformToVexNote(noteCode)],\n        duration: '4q',\n      }),\n    )\n\nexport const StaveSheet = (props: StaveProps) => {\n  const {\n    className,\n    width,\n    noteRange: {\n      first,\n      last,\n    },\n    noteKeyWidth,\n  } = props\n\n  const container = useRef<HTMLObjectElement>()\n\n  const trebleNotes: Flow.StaveNote[] = genVexNotes(NoteCode.C4, last)\n  const bassNotes: Flow.StaveNote[] = genVexNotes(first, NoteCode.B3)\n\n  useEffect(() => {\n    const renderer = new Renderer(\n      container.current,\n      Backends.SVG as any as Flow.Renderer.Backends,\n    )\n    render(renderer)\n  }, [])\n\n  const render = (renderer: Flow.Renderer) => {\n    renderer.resize(width, 140)\n    const context = renderer.getContext()\n\n    const bassStave = new Stave(0, 20, bassNotes.length * noteKeyWidth)\n      .addClef(Clef.bass)\n      .setContext(context)\n    bassStave.draw()\n\n    const bassBeams = Beam.generateBeams(bassNotes)\n    Formatter.FormatAndDraw(context, bassStave, bassNotes)\n    bassBeams.forEach(beam => beam.setContext(context).draw())\n\n    const trebleStave = new Stave(\n      bassNotes.length * noteKeyWidth,\n      20,\n      trebleNotes.length * noteKeyWidth,\n    )\n      .addClef(Clef.treble)\n      .setContext(context)\n    trebleStave.draw()\n\n    const trebleBeams = Beam.generateBeams(trebleNotes)\n    Formatter.FormatAndDraw(context, trebleStave, trebleNotes)\n    trebleBeams.forEach(beam => beam.setContext(context).draw())\n  }\n\n  return (\n    <S.StaveContainer>\n      <div\n        className={className}\n        ref={container}\n      />\n    </S.StaveContainer>\n  )\n}\n","import React from 'react'\nimport {\n  ArrowUpOutlined,\n  ArrowDownOutlined,\n  ArrowLeftOutlined,\n  ArrowRightOutlined,\n  StepForwardOutlined,\n  ForwardOutlined,\n  BackwardOutlined,\n} from '@ant-design/icons'\nimport { NamedKey } from '../keyboard'\nimport * as S from './styled'\n\n\nexport const KeyDisplay: Record<keyof typeof NamedKey, React.ReactNode> = {\n  backspace: '⌫',\n  delete: '⌦',\n  enter: '↩︎',\n  tab: '⇥',\n  escape: 'Esc',\n  up: <ArrowUpOutlined />,\n  down: <ArrowDownOutlined />,\n  right: <ArrowRightOutlined />,\n  left: <ArrowLeftOutlined />,\n  home: 'Home',\n  end: 'End',\n  pageUp: 'Page⇞',\n  pageDown: 'Page⇟',\n\n  f1: 'F1',\n  f2: 'F2',\n  f3: 'F3',\n  f4: 'F4',\n  f5: 'F5',\n  f6: 'F6',\n  f7: 'F7',\n  f8: 'F8',\n  f9: 'F9',\n  f10: 'F10',\n  f11: 'F11',\n  f12: 'F12',\n  f13: 'F13',\n  f14: 'F14',\n  f15: 'F15',\n  f16: 'F16',\n  f17: 'F17',\n  f18: 'F18',\n  f19: 'F19',\n  f20: 'F20',\n  f21: 'F21',\n  f22: 'F22',\n  f23: 'F23',\n  f24: 'F24',\n\n  capsLock: '⇪',\n  command: '⌘',\n  alt: '⌥',\n  rightAlt: '⌥',\n  control: '⌃',\n  leftControl: '⌃',\n  rightControl: '⌃',\n  shift: '⇧',\n  rightShift: '⇧',\n  space: 'Space',\n  printScreen: 'Screen',\n  insert: 'Insert',\n  menu: 'Menu',\n\n  audioMute: <S.EmojiIcon>🔊</S.EmojiIcon>,\n  audioVolDown: <><S.EmojiIcon>🔊</S.EmojiIcon>-</>,\n  audioVolUp: <><S.EmojiIcon>🔊</S.EmojiIcon>+</>,\n  audioPlay: <StepForwardOutlined />,\n  audioStop: <StepForwardOutlined />,\n  audioPause: <StepForwardOutlined />,\n  audioPrev: <BackwardOutlined />,\n  audioNext: <ForwardOutlined />,\n  audioRewind: 'Rewind',\n  audioForward: 'Forward',\n  audioRepeat: '⎔',\n  audioRandom: 'Random',\n  numpadLock: 'NumLock',\n\n  num1: '1',\n  num2: '2',\n  num3: '3',\n  num4: '4',\n  num5: '5',\n  num6: '6',\n  num7: '7',\n  num8: '8',\n  num9: '9',\n  num0: '0',\n\n  numpad0: '0',\n  numpad1: '1',\n  numpad2: '2',\n  numpad3: '3',\n  numpad4: '4',\n  numpad5: '5',\n  numpad6: '6',\n  numpad7: '7',\n  numpad8: '8',\n  numpad9: '9',\n  numpadPlus: '+',\n  numpadSub: '-',\n  numpadMulti: '*',\n  numpadDiv: '/',\n  numpadDot: '.',\n  lightsMonUp: <S.EmojiIcon>🔆</S.EmojiIcon>,\n  lightsMonDown: <S.EmojiIcon>🔅</S.EmojiIcon>,\n  lightsKbdToggle: 'Toggle',\n  lightsKbdUp: <S.EmojiIcon>⌨️🔆</S.EmojiIcon>,\n  lightsKbdDown: <S.EmojiIcon>⌨️🔅</S.EmojiIcon>,\n\n  a: 'A',\n  b: 'B',\n  c: 'C',\n  d: 'D',\n  e: 'E',\n  f: 'F',\n  g: 'G',\n  h: 'H',\n  i: 'I',\n  j: 'J',\n  k: 'K',\n  l: 'L',\n  m: 'M',\n  n: 'N',\n  o: 'O',\n  p: 'P',\n  q: 'Q',\n  r: 'R',\n  s: 'S',\n  t: 'T',\n  u: 'U',\n  v: 'V',\n  w: 'W',\n  x: 'X',\n  y: 'Y',\n  z: 'Z',\n\n  tilde: '`',\n\n  dash: '-',\n  equal: '=',\n\n  comma: ',',\n  dot: '.',\n  slash: '/',\n\n  semicolon: ';',\n  quotes: '\\'',\n\n  openBracket: '[',\n  closeBracket: ']',\n  backslash: '\\\\',\n\n  fn: 'Fn',\n  NULL: '',\n}\n","import React from 'react'\nimport { NamedKey } from '../keyboard'\nimport { NoteCode, NoteNameKey } from '../midi'\nimport { FnPortalConfigMap, PortalConfigMap } from '../portal'\nimport { KeyDisplay } from './keySheet'\nimport * as S from './styled'\nimport 'react-piano/dist/styles.css'\n\n\nexport const countWholeTones = (start: NoteCode, end: NoteCode): number => {\n  let count = 0\n  for (let code = start; code <= end; code++) {\n    if (!NoteCode[code].includes('Sharp')) {\n      count += 1\n    }\n  }\n  return count\n}\n\nexport const NoteLabel = (props: {\n  noteCode: NoteCode,\n}) => {\n  const { noteCode } = props\n\n  const noteName = NoteCode[noteCode].replace('Sharp', '#')\n\n  return (\n    <S.NoteName>\n      <span>\n        {noteName}\n      </span>\n    </S.NoteName>\n  )\n}\n\nexport const NamedKeyLabel = (props: {\n  noteCode: NoteCode,\n  portal: PortalConfigMap,\n  fnPortal: FnPortalConfigMap,\n}) => {\n  const { noteCode, portal, fnPortal } = props\n  const noteName = NoteCode[noteCode] as NoteNameKey\n  const key = KeyDisplay[portal[noteName]]\n\n  // notes which are used in fnPortal\n  const alterKeyMap = new Map(\n    Object.values(fnPortal)\n      .map(portal => Object.entries(portal))\n      .reduce((prev, curr) => [...prev, ...curr], [])\n      .filter(([, key]) => key),\n  ) as Map<NoteNameKey, keyof typeof NamedKey>\n\n  const alterKey = KeyDisplay[alterKeyMap.get(noteName)]\n\n  if (alterKey) {\n    return (\n      <S.KeyName>\n        <div>\n          <S.FnKbd>{alterKey}</S.FnKbd>\n        </div>\n        {key\n          ? <S.Kbd>{key}</S.Kbd>\n          : null\n        }\n      </S.KeyName>\n    )\n  }\n\n  if (!key) return null\n\n  const isFnNoteToggle = fnPortal[noteName]\n    && Object.values(fnPortal[noteName]).filter(Boolean).length > 0\n\n  if (isFnNoteToggle) {\n    return (\n      <S.KeyName>\n        <S.FnKbd>{key}</S.FnKbd>\n      </S.KeyName>\n    )\n  }\n\n  return (\n    <S.KeyName>\n      <S.Kbd>{key}</S.Kbd>\n    </S.KeyName>\n  )\n}\n\nexport const NoteKey = (props: {\n  noteCode: NoteCode,\n  isAccidental: boolean,\n  portal: PortalConfigMap,\n  fnPortal: FnPortalConfigMap,\n  isPlayMode: boolean,\n}) => {\n  const {\n    noteCode,\n    isAccidental,\n    portal,\n    fnPortal,\n    isPlayMode,\n  } = props\n\n  const noteLabel = <NoteLabel noteCode={noteCode} />\n  const NoteWrapper = isAccidental ? S.SharpNote : S.BaseNote\n\n  return (\n    <NoteWrapper>\n      {!isPlayMode && (\n        <NamedKeyLabel\n          noteCode={noteCode}\n          portal={portal}\n          fnPortal={fnPortal}\n        />\n      )}\n      {isAccidental ? null : noteLabel}\n    </NoteWrapper>\n  )\n}\n","// https://github.com/kevinsqi/react-piano\n\nimport React, { useEffect, useState, useRef, useCallback } from 'react'\nimport GithubCorner from 'react-github-corners'\nimport { SwitchProps } from 'antd/es/switch'\nimport { RawFileConfig } from '../configParser'\nimport { NoteCode } from '../midi'\n\nimport { ToggleKeys, PressedNotes, isSetEqual } from '../handlerType'\nimport { initReceiveMIDI } from './midi'\nimport { NoteKey, countWholeTones } from './PianoSheet'\nimport { StaveSheet, StaveProps } from './Stave'\nimport * as S from './styled'\n\nimport midkConfig from '../midk.yml'\nimport 'react-piano/dist/styles.css'\nimport 'react-github-corners/dist/GithubCorner.css'\nimport 'antd/es/switch/style/index.css'\nimport './index.css'\n\n\nconst projectRepo = process.env.REACT_APP_PROJECT_REPO\n\nconst { playMode, portal, fnPortal } = midkConfig as RawFileConfig\nconst toggles: ToggleKeys = new Set(playMode.toggle.map(codeName => NoteCode[codeName]))\n\nconst portalNotes = Object.keys(portal).map(name => NoteCode[name])\n\nexport const noteRange: StaveProps['noteRange'] = {\n  first: Math.min(...portalNotes),\n  last: Math.max(...portalNotes),\n}\n\nconst { noteKeyWidth, noteKeyWidthHeightRatio } = S\nconst notesWholeWidth = countWholeTones(noteRange.first, noteRange.last) * noteKeyWidth\nconst noop = () => { }\n\n\nexport const PlayModeSwitch = (props: SwitchProps) => (\n  <S.SwitchContainer>\n    <S.SwitchLabel activated={!props.checked}>\n      {`Control Mode`}\n    </S.SwitchLabel>\n    <S.Switch {...props} />\n    <S.SwitchLabel activated={props.checked}>\n      {`Play Mode`}\n    </S.SwitchLabel>\n  </S.SwitchContainer>\n)\n\nexport const App = () => {\n  const isPlayMode = useRef<boolean>(playMode.enable)\n  const [pressedNotes, setPressedNotes] = useState<PressedNotes>(new Set())\n\n  useEffect(() => {\n    const onPressedNotes = (notes: PressedNotes, isPress: boolean) => {\n      if (isPress && isSetEqual(notes, toggles)) {\n        isPlayMode.current = !isPlayMode.current\n      }\n      setPressedNotes(new Set([...notes]))\n    }\n\n    initReceiveMIDI(onPressedNotes)\n  }, [])\n\n  const renderNoteLabel = useCallback(\n    ({ midiNumber, isAccidental }) => (\n      <NoteKey\n        noteCode={midiNumber}\n        isAccidental={isAccidental}\n        portal={portal}\n        fnPortal={fnPortal}\n        isPlayMode={isPlayMode.current}\n      />\n    ),\n    [isPlayMode.current],\n  )\n\n  return (\n    <S.Background>\n      {projectRepo && (\n        <GithubCorner\n          url={projectRepo}\n          backgroundColor={`white`}\n          color={`var(--global-background)`}\n          svgStyle={{\n            position: 'fixed',\n          }}\n        />\n      )}\n      <PlayModeSwitch\n        checked={isPlayMode.current}\n        onChange={(checked) => {\n          isPlayMode.current = checked\n          setPressedNotes(new Set())\n        }}\n      />\n      <S.BodyContainer>\n        <S.Piano\n          noteRange={noteRange}\n          width={notesWholeWidth}\n          activeNotes={[...pressedNotes]}\n          playNote={noop}\n          stopNote={noop}\n          disabled={false}\n          keyWidthToHeight={noteKeyWidthHeightRatio}\n          renderNoteLabel={renderNoteLabel}\n        />\n        {isPlayMode.current && (\n          <StaveSheet\n            width={notesWholeWidth}\n            noteRange={noteRange}\n            noteKeyWidth={noteKeyWidth}\n          />\n        )}\n      </S.BodyContainer>\n    </S.Background>\n  )\n}\n\n\n\n\n","/**\n * `index.web.ts` is in front of `index.ts`\n *\n * due to extension order in `moduleFileExtensions`\n *\n * https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/config/paths.js#L32\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { App } from './PianoSheet'\n\n\nconst rootElement = document.getElementById('root')\nReactDOM.render(\n  React.createElement(App),\n  rootElement,\n)\n\n\n"],"sourceRoot":""}